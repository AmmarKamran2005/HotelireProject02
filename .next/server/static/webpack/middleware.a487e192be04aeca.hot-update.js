"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jose */ \"(middleware)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n\n\nasync function middleware(request) {\n    const url = request.nextUrl.clone();\n    const token = request.cookies.get(\"token\")?.value;\n    if (!token) {\n        if (url.pathname.startsWith(\"/admin\") || url.pathname.startsWith(\"/owner\")) {\n            url.pathname = \"/customer/signin\";\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    try {\n        // âœ… Verify token using jose\n        const secret = new TextEncoder().encode(process.env.JWT_SECRET);\n        const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_1__.jwtVerify)(token, secret);\n        //    url.searchParams.set(\"debug\", JSON.stringify(payload));\n        //  return NextResponse.redirect(url);\n        const roleId = parseInt(payload.user?.roleid);\n        if (url.pathname.startsWith(\"/admin\") && roleId !== 1) {\n            url.pathname = \"/unauthorized\";\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n        }\n        if (url.pathname.startsWith(\"/owner\") && roleId !== 2) {\n            url.pathname = \"/unauthorized\";\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    } catch (err) {\n        console.error(\"JWT verification failed:\", err);\n        url.pathname = \"/customer/signin\";\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n    }\n}\nconst config = {\n    matcher: [\n        \"/admin/:path*\",\n        \"/owner/:path*\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBRTJDO0FBRVY7QUFFMUIsZUFBZUUsV0FBV0MsT0FBb0I7SUFDbkQsTUFBTUMsTUFBTUQsUUFBUUUsT0FBTyxDQUFDQyxLQUFLO0lBQ2pDLE1BQU1DLFFBQVFKLFFBQVFLLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFVBQVVDO0lBRTVDLElBQUksQ0FBQ0gsT0FBTztRQUNWLElBQUlILElBQUlPLFFBQVEsQ0FBQ0MsVUFBVSxDQUFDLGFBQWFSLElBQUlPLFFBQVEsQ0FBQ0MsVUFBVSxDQUFDLFdBQVc7WUFDMUVSLElBQUlPLFFBQVEsR0FBRztZQUNmLE9BQU9YLHFEQUFZQSxDQUFDYSxRQUFRLENBQUNUO1FBQy9CO1FBQ0EsT0FBT0oscURBQVlBLENBQUNjLElBQUk7SUFDMUI7SUFFQSxJQUFJO1FBQ0YsNEJBQTRCO1FBQzVCLE1BQU1DLFNBQVMsSUFBSUMsY0FBY0MsTUFBTSxDQUFDQyxRQUFRQyxHQUFHLENBQUNDLFVBQVU7UUFDOUQsTUFBTSxFQUFFQyxPQUFPLEVBQUUsR0FBTyxNQUFNcEIsK0NBQVNBLENBQUNNLE9BQU9RO1FBRS9DLDZEQUE2RDtRQUM3RCxzQ0FBc0M7UUFHdkMsTUFBTU8sU0FBU0MsU0FBU0YsUUFBUUcsSUFBSSxFQUFFQztRQUdyQyxJQUFJckIsSUFBSU8sUUFBUSxDQUFDQyxVQUFVLENBQUMsYUFBYVUsV0FBVyxHQUFHO1lBQ3JEbEIsSUFBSU8sUUFBUSxHQUFHO1lBQ2YsT0FBT1gscURBQVlBLENBQUNhLFFBQVEsQ0FBQ1Q7UUFDL0I7UUFFQSxJQUFJQSxJQUFJTyxRQUFRLENBQUNDLFVBQVUsQ0FBQyxhQUFhVSxXQUFXLEdBQUc7WUFDckRsQixJQUFJTyxRQUFRLEdBQUc7WUFDZixPQUFPWCxxREFBWUEsQ0FBQ2EsUUFBUSxDQUFDVDtRQUMvQjtRQUVBLE9BQU9KLHFEQUFZQSxDQUFDYyxJQUFJO0lBQzFCLEVBQUUsT0FBT1ksS0FBSztRQUNaQyxRQUFRQyxLQUFLLENBQUMsNEJBQTRCRjtRQUMxQ3RCLElBQUlPLFFBQVEsR0FBRztRQUNmLE9BQU9YLHFEQUFZQSxDQUFDYSxRQUFRLENBQUNUO0lBQy9CO0FBQ0Y7QUFFTyxNQUFNeUIsU0FBUztJQUNwQkMsU0FBUztRQUFDO1FBQWlCO0tBQWdCO0FBQzdDLEVBQUUiLCJzb3VyY2VzIjpbIkM6XFxQcm9qZWN0c1xcSG90ZWxpcmVcXEhvdGVsaXJlRnJvbnRlbmRcXEhvdGVsaXJlUHJvamVjdDAyXFxtaWRkbGV3YXJlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB0eXBlIHsgTmV4dFJlcXVlc3QgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgand0VmVyaWZ5IH0gZnJvbSBcImpvc2VcIjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgY29uc3QgdXJsID0gcmVxdWVzdC5uZXh0VXJsLmNsb25lKCk7XHJcbiAgY29uc3QgdG9rZW4gPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KFwidG9rZW5cIik/LnZhbHVlO1xyXG5cclxuICBpZiAoIXRva2VuKSB7XHJcbiAgICBpZiAodXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYWRtaW5cIikgfHwgdXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvb3duZXJcIikpIHtcclxuICAgICAgdXJsLnBhdGhuYW1lID0gXCIvY3VzdG9tZXIvc2lnbmluXCI7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QodXJsKTtcclxuICAgIH1cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIC8vIOKchSBWZXJpZnkgdG9rZW4gdXNpbmcgam9zZVxyXG4gICAgY29uc3Qgc2VjcmV0ID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgY29uc3QgeyBwYXlsb2FkIH06YW55ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBzZWNyZXQpO1xyXG5cclxuICAgIC8vICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiZGVidWdcIiwgSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpO1xyXG4gICAgLy8gIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QodXJsKTtcclxuXHJcblxyXG4gICBjb25zdCByb2xlSWQgPSBwYXJzZUludChwYXlsb2FkLnVzZXI/LnJvbGVpZCk7XHJcblxyXG5cclxuICAgIGlmICh1cmwucGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hZG1pblwiKSAmJiByb2xlSWQgIT09IDEpIHtcclxuICAgICAgdXJsLnBhdGhuYW1lID0gXCIvdW5hdXRob3JpemVkXCI7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QodXJsKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvb3duZXJcIikgJiYgcm9sZUlkICE9PSAyKSB7XHJcbiAgICAgIHVybC5wYXRobmFtZSA9IFwiL3VuYXV0aG9yaXplZFwiO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiSldUIHZlcmlmaWNhdGlvbiBmYWlsZWQ6XCIsIGVycik7XHJcbiAgICB1cmwucGF0aG5hbWUgPSBcIi9jdXN0b21lci9zaWduaW5cIjtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QodXJsKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgbWF0Y2hlcjogW1wiL2FkbWluLzpwYXRoKlwiLCBcIi9vd25lci86cGF0aCpcIl0sXHJcbn07XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJqd3RWZXJpZnkiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsInVybCIsIm5leHRVcmwiLCJjbG9uZSIsInRva2VuIiwiY29va2llcyIsImdldCIsInZhbHVlIiwicGF0aG5hbWUiLCJzdGFydHNXaXRoIiwicmVkaXJlY3QiLCJuZXh0Iiwic2VjcmV0IiwiVGV4dEVuY29kZXIiLCJlbmNvZGUiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsInBheWxvYWQiLCJyb2xlSWQiLCJwYXJzZUludCIsInVzZXIiLCJyb2xlaWQiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJjb25maWciLCJtYXRjaGVyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});